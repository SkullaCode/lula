class Result{Code=null;Status=null;Message=null;Data=null;ActionBtn=null;Component=null;NotificationType=null}class Requirement{Site="";Method=null;Request="POST";Notification="true";Headers=[];SuccessHandler=null;ErrorHandler=null;Component=null;ActionBtn=null;ResponseType=null;Params=new FormData;Complete=null}let MainContainer="MainContainer",ModalContainer="modal-container",TemplateContainer="container-panel";const HARD_RELOAD_HEADER="x-reload-app",HARD_REDIRECT_HEADER="x-redirect-app",TOASTER_NOTIFICATION_TYPE="toaster",ALERT_NOTIFICATION_TYPE="alert",NONE_NOTIFICATION_TYPE="none";window.Controller=function(){let e=function(e,r){t[e]=r},t={AddProperty:e,AddMethod:function(t,r){e(t,r)},FormSubmit:null,FileSelect:null,ModalSelect:null,PanelSelect:null};return t}(),window.Service=function(){let e=function(e,r){t[e]=r},t={LoadedModal:null,LoadedPanel:{},LoadedForm:null,PanelLoading:[],ModalLoading:null,ActionLoading:null,ModelData:{Lists:{},Listing:[],SelectedEntity:{}},MetaData:{},ContainerPanel:null,Title:"Javascript UI",Modification:null,SubmitTransformation:null,Transformation:null,DomEvents:null,Data:null,AuthorizationHandler:null,ErrorHandler:null,SuccessHandler:null,NotificationHandler:null,ErrorMessageHandler:null,ErrorDataHandler:null,SuccessMessageHandler:null,SuccessDataHandler:null,DefaultModalHandler:null,DefaultElementHandler:null,ServerRequest:null,LaunchModal:null,Bind:null,BindForm:null,BindList:null,GetProperty:null,ListUpdate:null,TriggerEvents:null,ImagePreview:null,LoadPanel:null,LoadModal:null,LoadData:null,LoadLayout:null,LoadPanelTransition:null,SelectListBuilder:null,FindElement:null,Transform:null,ExecuteCustom:null,ExecuteSubmitTransformation:null,ReloadPanel:null,ToasterNotification:null,AlertNotification:null,LoadingStateOn:null,LoadingStateOff:null,CanSubmitForm:null,FindElementSync:null,FormData:null,Link:null,AddProperty:e,AddMethod:function(t,r){e(t,r)},SYSTEM_ID:"id",SYSTEM_PROPERTY:"property",SYSTEM_TARGET:"target",SYSTEM_COMPLETE:"complete",SYSTEM_HEADERS:"headers",SYSTEM_ACTION:"action",SYSTEM_CUSTOM:"custom",SYSTEM_URL:"href",SYSTEM_METHOD:"method",SYSTEM_HISTORY:"history",SYSTEM_FILE_UPLOAD_CONTAINER:".file-upload",SYSTEM_CLEAR_ERROR:"clear-error",SYSTEM_CLEAR_SUCCESS:"clear-success",SYSTEM_LIST:"list",SYSTEM_BIND:"bind",SYSTEM_BIND_VALUE:"bind-value",SYSTEM_BIND_ELEM:"bind-element",SYSTEM_BIND_GLOBAL:"bind-global",SYSTEM_LOOP:"loop",SYSTEM_BIND_LOOP:"bind-loop",SYSTEM_SUCCESS_HANDLER:"success-handler",SYSTEM_ERROR_HANDLER:"error-handler",SYSTEM_LOAD_TYPE:"load-type",SYSTEM_NOTIFICATION_ON_SUCCESS:"notification-success",SYSTEM_NOTIFICATION_ON_ERROR:"notification-error",SYSTEM_NOTIFICATION:"notification",SYSTEM_TITLE:"title",SYSTEM_DEFAULT:"default",SYSTEM_HIDE:"hide"};return t}(),window.Service.AddProperty("Modification",function(){let e={AddMethod:function(t,r){e[t]=r}};return e}()),window.Service.AddProperty("SubmitTransformation",function(){let e={AddMethod:function(t,r){e[t]=r}};return e}()),window.Service.AddProperty("Transformation",function(){let e={AddMethod:function(t,r){e[t]=r}};return e}()),window.Service.AddProperty("Data",function(){let e={AddMethod:function(t,r){e[t]=r},Store:{}};return e}()),Service.AddProperty("AuthorizationHandler",(function(e){e.NotificationType="alert",Service.NotificationHandler(e)})),Service.AddProperty("ErrorHandler",(function(e){null!==Service.LoadedForm&&Service.LoadedForm.find("input,select,textarea,button").each((function(){let e=jQuery(this);e.hasClass(Service.SYSTEM_CLEAR_ERROR)&&("select-one"===e.prop("type")?e.prop("selectedIndex",0):(e.is("input")||e.is("textarea"))&&e.val(""))}))})),Service.AddProperty("SuccessHandler",(function(e){null!==Service.LoadedForm&&Service.LoadedForm.find("input,select,textarea,button").each((function(){let e=jQuery(this);e.hasClass(Service.SYSTEM_CLEAR_SUCCESS)&&("select-one"===e.prop("type")?e.prop("selectedIndex",0):(e.is("input")||e.is("textarea"))&&e.val(""))}))})),Service.AddProperty("NotificationHandler",(function(e){switch(e.NotificationType){case"alert":"function"==typeof Service.AlertNotification?Service.AlertNotification(e):alert(e.Message);break;case"toaster":"function"==typeof Service.ToasterNotification?Service.ToasterNotification(e):alert(e.Message);break;case"none":break;default:"success"===e.Status?"function"==typeof Service.ToasterNotification?Service.ToasterNotification(e):alert(e.Message):"function"==typeof Service.AlertNotification?Service.AlertNotification(e):alert(e.Message)}})),Service.AddProperty("DefaultElementHandler",(function(e){const t=jQuery("<div></div>",{class:"alert alert-danger"}),r=void 0!==e.data(Service.SYSTEM_LOAD_TYPE)?e.data(Service.SYSTEM_LOAD_TYPE):"panel";return t.append(`<p>The ${r} you are trying to load experienced an error while rendering....</p>`),t})),Service.AddProperty("DefaultModalHandler",(function(e,t){if(!e.hasClass("modal")){const t=e.find(".modal");if(1===t.length)return t;{let t=e.data(Service.SYSTEM_ACTION);"string"!=typeof t&&(t="");const r=e.html();return jQuery(`<div class="modal fade" role="dialog" data-action="${t}">\n                    <div class="modal-dialog">\n                        <div class="modal-content">\n                            <div class="modal-header">\n                                <button type="button" class="close" data-dismiss="modal">&times;</button>\n                                <h4 class="modal-title"></h4>\n                            </div>\n                            <div class="modal-body">\n                                ${r}\n                            </div>\n                            <div class="modal-footer">\n                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>`)}}})),Service.AddProperty("ErrorMessageHandler",(function(e,t,r){let n=e.getResponseHeader("x-error-message");if(null!=n&&n.length>0)return n;if(void 0!==t&&(n=t,null!=n&&n.length>0))return n;if(void 0!==e.responseJSON&&void 0!==e.responseJSON.message&&(n=e.responseJSON.message,null!=n&&n.length>0))return n;if(void 0!==e.responseText&&e.responseText.length>0){try{n=JSON.parse(e.responseText).message}catch(e){n=null}if(null!=n&&n.length>0)return n}return n=e.statusText,null!=n&&n.length>0?n:"Internal Server Error!"})),Service.AddProperty("ErrorDataHandler",(function(e,t,r){let n={};if(void 0!==e.responseJSON)n=e.responseJSON;else if(void 0!==e.responseText&&e.responseText.length>0)try{n=JSON.parse(e.responseText)}catch(e){}return n})),Service.AddProperty("SuccessMessageHandler",(function(e,t,r){let n=e.getResponseHeader("x-success-message");return null!=n&&n.length>0?n:(n=e.statusText,null!=n&&n.length>0||void 0!==t.message&&(n=t.message,null!=n&&n.length>0)?n:"Task completed!")})),Service.AddProperty("SuccessDataHandler",(function(e,t,r){return t})),Service.AddProperty("ServerRequest",(function(e){void 0!==e.Method&&null!==e.Method&&(e.Request=e.Method),void 0!==e.Headers&&null!==e.Headers||(e.Headers=[]),void 0!==e.SuccessHandler&&null!==e.SuccessHandler||(e.SuccessHandler=Service.SuccessHandler),void 0!==e.ErrorHandler&&null!==e.ErrorHandler||(e.ErrorHandler=Service.ErrorHandler),void 0!==e.Component&&null!==e.Component||(e.Component=jQuery("<div></div>")),void 0!==e.ResponseType&&null!==e.ResponseType||(e.ResponseType="json"),void 0===e.ActionBtn||null===e.ActionBtn?(e.ActionBtn=jQuery("<button></button>",{type:"button"}),void 0!==e.Notification&&0!==e.Notification.length||(e.Notification="true")):void 0!==e.Notification&&0!==e.Notification.length||void 0===e.ActionBtn.data(Service.SYSTEM_NOTIFICATION)?e.Notification="true":e.Notification=e.ActionBtn.data(Service.SYSTEM_NOTIFICATION),null===e.Params&&(e.Params=new FormData),Service.LoadingStateOn(e.ActionBtn);const t=function(t,r,n){if(Service.LoadingStateOff(e.ActionBtn),n.getResponseHeader("x-reload-app"))return void location.reload();if(n.getResponseHeader("x-redirect-app"))return void(location.href=n.getResponseHeader("x-redirect-app"));let i=new Result;i.Code=n.statusCode,i.Status=r,i.Data=Service.SuccessDataHandler(n,t,e.ActionBtn),i.Message=Service.SuccessMessageHandler(n,t,e.ActionBtn),i.ActionBtn=e.ActionBtn,i.Component=e.Component,"true"!==e.Notification&&"success"!==e.Notification||(i.NotificationType=e.ActionBtn.data(Service.SYSTEM_NOTIFICATION_ON_SUCCESS)||"toaster",Service.NotificationHandler(i)),e.SuccessHandler(i),void 0!==e.Complete&&null!==e.Complete?Service.ExecuteCustom(e.Complete,e.Component,e.ActionBtn,i).then((()=>{Service.ActionLoading=!1})):void 0!==e.ActionBtn.data(Service.SYSTEM_COMPLETE)&&null!==e.ActionBtn.data(Service.SYSTEM_COMPLETE)?Service.ExecuteCustom(e.ActionBtn.data(Service.SYSTEM_COMPLETE),e.Component,e.ActionBtn,i).then((()=>{Service.ActionLoading=!1})):Service.ActionLoading=!1},r={url:e.Site,type:e.Request,success:t,error:function(r,n,i){if(200===r.status)return void t({},"success",r);const o=new Result;if(o.Code=r.status,o.Status=n,o.ActionBtn=e.ActionBtn,o.Component=e.Component,Service.LoadingStateOff(e.ActionBtn),o.Data=Service.ErrorDataHandler(r,i,e.ActionBtn),o.Message=Service.ErrorMessageHandler(r,i,e.ActionBtn),401===r.status||403===r.status)return Service.AuthorizationHandler(o),void(Service.ActionLoading=!1);e.ErrorHandler(o),void 0!==e.Complete&&null!==e.Complete?Service.ExecuteCustom(e.Complete,e.Component,e.ActionBtn,o).then((()=>{"true"!==e.Notification&&"error"!==e.Notification||(o.NotificationType=e.ActionBtn.data(Service.SYSTEM_NOTIFICATION_ON_ERROR)||"alert",Service.NotificationHandler(o)),Service.ActionLoading=!1})):("true"!==e.Notification&&"error"!==e.Notification||(o.NotificationType=e.ActionBtn.data(Service.SYSTEM_NOTIFICATION_ON_ERROR)||"alert",Service.NotificationHandler(o)),Service.ActionLoading=!1)},beforeSend:function(t){t.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.Headers.length>0&&jQuery.each(e.Headers,(function(){t.setRequestHeader(this.Name,this.Value)}))}};["POST","PUT","HEAD","DELETE"].indexOf(e.Request.toUpperCase())>=0&&(r.data=e.Params),r.dataType=e.ResponseType,r.processData=!1,r.contentType=!1,r.global=!1,jQuery.ajax(r)})),Service.AddProperty("LaunchModal",(function(e,t){return new Promise((function(r){e.on("hide.bs.modal",(function(e){Service.ExecuteCustom(t.data(Service.SYSTEM_HIDE),this,t,e)})),e.on("hidden.bs.modal",(function(){Service.LoadedModal.remove(),Service.LoadedModal=null,jQuery(`.${ModalContainer}`).empty()})),e.modal(),r(!0)}))})),Service.AddProperty("Bind",(function(e,t,r=null){let n=[];e.hasClass(`${Service.SYSTEM_BIND}`)?n.push(e):n=e.find(`.${Service.SYSTEM_BIND}`),jQuery.each(n,(function(){let e=jQuery(this);if(e.hasClass(Service.SYSTEM_BIND_GLOBAL)){if(void 0!==e.data(Service.SYSTEM_CUSTOM)){e.data(Service.SYSTEM_CUSTOM).split("|").forEach((function(n){Service.Transformation.hasOwnProperty(n)?Service.Transformation[n](e,t,r):Controller.hasOwnProperty(n)&&Controller[n](e,t,r)}))}}else if("IMG"===e.prop("tagName"))void 0!==e.data(Service.SYSTEM_PROPERTY)?e.prop("src",Service.GetProperty(e.data(Service.SYSTEM_PROPERTY),t)):void 0!==e.prop("id")&&e.prop("src",Service.GetProperty(e.prop("id"),t));else if(void 0!==e.data(Service.SYSTEM_PROPERTY))Service.BindProperty(e,e.data(Service.SYSTEM_PROPERTY),t,r);else if(void 0!==e.data(Service.SYSTEM_LOOP)){let n=Service.GetProperty(e.data(Service.SYSTEM_LOOP),t);if(void 0===n)return;let i=e.children();e.empty(),"object"==typeof n&&null!==n&&n.length>0&&n.forEach((function(t){let o=i.clone(),a=o.find(`.${Service.SYSTEM_BIND_LOOP}`);o.hasClass(`${Service.SYSTEM_BIND_LOOP}`)&&(o.hasClass(Service.SYSTEM_BIND_GLOBAL)?Service.BindProperty(o,null,n,r):void 0!==o.data(Service.SYSTEM_PROPERTY)?Service.BindProperty(o,o.data(Service.SYSTEM_PROPERTY),t,r):Service.BindProperty(o,o.prop("id"),t,r)),a.length>0&&$.each(a,(function(){let e=jQuery(this);e.hasClass(Service.SYSTEM_BIND_GLOBAL)?Service.BindProperty(e,null,n,r):void 0!==e.data(Service.SYSTEM_PROPERTY)?Service.BindProperty(e,e.data(Service.SYSTEM_PROPERTY),t,r):Service.BindProperty(e,e.prop("id"),t,r)})),e.append(o)})),void 0!==e.data(Service.SYSTEM_CUSTOM)&&(e=Service.Transform(e.data(Service.SYSTEM_CUSTOM),e,r))}else e.prop("id").length>0&&Service.BindProperty(e,e.prop("id"),t,r)}))})),Service.AddProperty("BindForm",(function(e,t){if(null===t)return;if(void 0===e)return;let r=jQuery(e).find("input,select,textarea");if(!(r.length<=0)){for(let e=0;e<r.length;e++){let n=null,i=jQuery(r[e]);if(n=Service.GetProperty(i.prop("id"),t),null!=n&&"object"!=typeof n||(n=Service.GetProperty(i.prop("name"),t)),null!=n&&"object"!=typeof n)switch(i[0].type){case"checkbox":case"radio":i.prop("checked",n==i.val());break;case"date":if(n){let e=new Date(n),t=("0"+e.getDate()).slice(-2),r=("0"+(e.getMonth()+1)).slice(-2);e=e.getFullYear()+"-"+r+"-"+t,i.data("value",e),i.val(e)}else i.val("");break;case"select-one":{i.data("value",n);let e=i.find("option");i.prop("selectedIndex",0),e.each((function(e){this.value==n&&i.prop("selectedIndex",e)}));break}case"select-multiple":break;default:i.data("value",n),i.val(n)}}for(let e=0;r&&e<r.length;e++)Service.TriggerEvents(jQuery(r[e]))}})),Service.AddProperty("BindList",(function(e,t=[],r=null){if(void 0!==t&&"string"!=typeof t&&null!==t&&"object"==typeof t&&t.length>0)Service.SelectListBuilder(e,t);else{const t=e.find("select");jQuery.each(t,(function(){let e=jQuery(this),t=e.data(Service.SYSTEM_LIST);if(void 0!==t){let n=Service.GetProperty(t,Service.ModelData.Lists);(null==n||n.length<=0)&&Controller.hasOwnProperty(t)&&(n=Controller[t](r)),null!=n&&n.length>0?Service.SelectListBuilder(e,n):e.data(Service.SYSTEM_DEFAULT)&&Service.SelectListBuilder(e,[])}else Service.SelectListBuilder(e,[])}))}})),Service.AddProperty("BindProperty",(function(e,t,r,n){if(null==t||t.length<=0)return void(void 0!==e.data(Service.SYSTEM_CUSTOM)&&(e.hasClass(Service.SYSTEM_BIND_ELEM)||e.hasClass(Service.SYSTEM_BIND_GLOBAL))&&Service.Transform(e.data(Service.SYSTEM_CUSTOM),e,r,n));let i=Service.GetProperty(t,r);if(void 0!==i)if(void 0!==e.data(Service.SYSTEM_CUSTOM)&&(e.hasClass(Service.SYSTEM_BIND_ELEM)||(i=Service.Transform(e.data(Service.SYSTEM_CUSTOM),null,i,n))),e.hasClass(Service.SYSTEM_BIND_ELEM))Service.Transform(e.data(Service.SYSTEM_CUSTOM),e,i,n);else if(e.hasClass(Service.SYSTEM_BIND_VALUE)){if(e.is("input,select,textarea")&&e.val(i),e.attr("data-value",i),"SELECT"===e.prop("tagName")){let t=e.find("option");e.prop("selectedIndex",0),t.each((function(t){this.value==i&&e.prop("selectedIndex",t)}))}}else e.html(i)})),Service.AddProperty("GetProperty",(function(e,t){if(null===e)return t;if(void 0===e)return t;e=e.split(".");let r=t;if(void 0===r)return null;for(let t=0;t<e.length&&!(e[t].length<=0)&&(r=r[e[t]],null!==r)&&void 0!==r;t++)if("object"!=typeof r)return r;return r})),Service.AddProperty("TriggerEvents",(function(e){let t=e.prop("onclick"),r=e.prop("onchange"),n=e.prop("onblur");null!==t&&e.click(),null!==r&&e.change(),null!==n&&e.blur()})),Service.AddProperty("ImagePreview",(function(e,t){if(1===e.length&&e[0].files[0]){let r=new FileReader;r.onload=function(e){t.prop("src",e.target.result)},r.readAsDataURL(e[0].files[0])}})),Service.AddProperty("LoadPanel",(function(e,t,r){return new Promise((t=>{const n=jQuery("<div></div>");Service.ContainerPanel=jQuery(`#${TemplateContainer}`),Service.ContainerPanel.length<=0&&(jQuery("<body>").append(n),Service.ContainerPanel=n),Service.ContainerPanel.empty().append(e);let i=null!=r&&r.length>0?jQuery(`#${r}`):jQuery(`#${MainContainer}`);return Service.LoadPanelTransition(i,e),Service.ContainerPanel.empty(),Service.ContainerPanel=null,n.empty().remove(),t(e)}))})),Service.AddProperty("LoadModal",(function(e,t){return new Promise((r=>{let n=e;n.hasClass("modal")||(n=Service.DefaultModalHandler(e,t));jQuery(`#${ModalContainer}`).empty().append(n);const i=t.data(),o=[Service.SYSTEM_ACTION,Service.SYSTEM_COMPLETE];jQuery.each(i,(function(e,t){-1===jQuery.inArray(e,o)&&n.data(e,t)})),r(n)}))})),Service.AddProperty("LoadData",(function(e,t){return new Promise((function(r){let n=e.data(Service.SYSTEM_ACTION);Service.Data.hasOwnProperty(n)||(n=`${t.data(Service.SYSTEM_ACTION)}-data`),Service.Data.hasOwnProperty(n)?Service.Data[n](e,t).then((function(e){r(e)})):r(!0)}))})),Service.AddProperty("SelectListBuilder",(function(e,t,r,n=!0){"string"==typeof e&&("#"!==e.substring(0,1)&&(e=`#${e}`),e=jQuery(e)),n&&e.empty();const i=e.data("default");i&&e.append(`<option data-value="" value=""> ${i} </option>`),jQuery.each(t,(function(){let t="",r="";void 0!==this.value&&(t=this.value),0===t.length&&void 0!==this.Value&&(t=this.Value),0===t.length&&void 0!==this.VALUE&&(t=this.VALUE),void 0!==this.text&&(r=this.text),0===r.length&&void 0!==this.Text&&(r=this.Text),0===r.length&&void 0!==this.TEXT&&(r=this.TEXT),e.append(`<option data-value="${t}" value="${t}"> ${r} </option>`)}))})),Service.AddProperty("FindElement",(function(e,t=null){return new Promise((r=>{let n=jQuery("template").prop("content");n=jQuery(n);let i="";if(void 0!==e&&e.length>0&&("#"!==e.substring(0,1)&&(e=`#${e}`),i=n.find(e)),i.length>0){let n=jQuery(i[0]).clone();const o=n.data(Service.SYSTEM_ACTION);let a=jQuery(n.html());1!==a.length&&(a=jQuery("<div></div>").append(n.html())),void 0!==o?a.data(Service.SYSTEM_ACTION,o):a.data(Service.SYSTEM_ACTION,e.substring(1)),Service.BindList(a,[],t),r(a)}else{const e=jQuery("<div></div>");e.append(Service.DefaultElementHandler(t)),r(e)}}))})),Service.AddProperty("FindElementSync",(function(e,t=null){let r=jQuery("template").prop("content");r=jQuery(r);let n="";if(void 0!==e&&e.length>0&&("#"!==e.substring(0,1)&&(e=`#${e}`),n=r.find(e)),n.length>0){let e=jQuery(n[0]).clone();const r=e.data(Service.SYSTEM_ACTION);let i=jQuery(e.html());return 1!==i.length&&(i=jQuery("<div></div>").append(e.html())),void 0!==r&&i.data(Service.SYSTEM_ACTION,r),Service.BindList(i,[],t),i}{const e=jQuery("<div></div>");return e.append(Service.DefaultElementHandler(t)),e}})),Service.AddProperty("ExecuteCustom",(function(e,t,r,n=null){return new Promise((function(i){if(null!=e&&e.length>0)return(e=e.split("|")).forEach((function(e){Service.Modification.hasOwnProperty(e)?Service.Modification[e](t,r,n):Controller.hasOwnProperty(e)&&Controller[e](t,r,n)})),i(!0);i(!1)}))})),Service.AddProperty("Transform",(function(e,t,r,n){return"string"==typeof e&&e.length>0&&(e=e.split("|")).forEach((function(e){null===t?Service.Transformation.hasOwnProperty(e)?r=Service.Transformation[e](r,null,n):Controller.hasOwnProperty(e)&&(r=Controller[e](r,null,n)):Service.Transformation.hasOwnProperty(e)?Service.Transformation[e](t,r,n):Controller.hasOwnProperty(e)&&Controller[e](t,r,n)})),r})),Service.AddProperty("ExecuteSubmitTransformation",(function(e,t,r,n){return(e=e.split("|")).forEach((function(e){Service.SubmitTransformation.hasOwnProperty(e)?r=Service.SubmitTransformation[e](t,r,n):Controller.hasOwnProperty(e)&&(t=Controller[e](t,r,n))})),r})),Service.AddProperty("LoadingStateOn",(function(e){null!==Service.LoadedForm&&Service.LoadedForm.find("input,select,textarea").prop("disabled",!0),e.prop("disabled",!0)})),Service.AddProperty("LoadingStateOff",(function(e){null!==Service.LoadedForm&&Service.LoadedForm.find("input,select,textarea").prop("disabled",!1),e.prop("disabled",!1)})),Service.AddProperty("LoadPanelTransition",(function(e,t,r=null){e.css("display","none"),e.empty(),e.html(t).fadeIn("slow")})),Service.AddProperty("FormData",(function(e){const t=new FormData;return jQuery.isArray(e)?jQuery.each(e,(function(){t.append(this.name,this.value)})):jQuery.each(e,(function(r){e.hasOwnProperty(r)&&t.append(r,e[r])})),t})),Service.AddProperty("Link",(function(e,t=null,r="",n="error",i={}){const o=jQuery("<a></a>");return null!=e&&"object"==typeof e?(jQuery.each(e,(function(t){e.hasOwnProperty(t)&&o.attr(`data-${t}`,e[t])})),o[0]):(o.attr("data-action",e),null!==t&&o.attr("data-target",t),o.attr("data-complete",r),o.attr("data-notification",n),"object"==typeof i&&null!==i&&i.length>0&&jQuery.each(i,(function(e){i.hasOwnProperty(e)&&o.attr(`data-${e}`,i[e])})),o[0])})),Controller.AddProperty("FormSubmit",(function(e){if(Service.ActionLoading)return!1;const t=jQuery(e);Service.ActionLoading=!0,Service.CanSubmitForm=!0;let r=t.data(Service.SYSTEM_TARGET);void 0===r&&(r=t.data(Service.SYSTEM_ACTION));let n=t.data(Service.SYSTEM_CUSTOM),i=t.data(Service.SYSTEM_COMPLETE),o=t.data(Service.SYSTEM_HEADERS),a=[],l=t.data(Service.SYSTEM_URL),d="post",c=new FormData,S=[],s=[];if(void 0===r)Service.LoadedForm=jQuery(t.parents("form")),void 0!==Service.LoadedForm.attr("action")&&(l=Service.LoadedForm.attr("action")),void 0!==Service.LoadedForm.attr("method")&&(d=Service.LoadedForm.attr("method")),s=Service.LoadedForm.serializeArray();else{"#"!==r.substring(0,1)&&(r=`#${r}`);const e=jQuery(document).find(r);if(a=e.is("form")?e:e.find("form"),a.length>0)Service.LoadedForm=a,l=a.prop("action"),d=a.prop("method"),void 0!==a.data(Service.SYSTEM_URL)&&(l=a.data(Service.SYSTEM_URL)),void 0!==a.data(Service.SYSTEM_METHOD)&&(d=a.data(Service.SYSTEM_METHOD)),s=a.serializeArray();else{const t=e.clone();a=jQuery("<form></form>"),a.append(t.children());const r=e.find("select");jQuery(r).each((function(e){a.find("select").eq(e).val(jQuery(this).val())})),void 0!==e.data(Service.SYSTEM_URL)&&(l=e.data(Service.SYSTEM_URL)),void 0!==e.data(Service.SYSTEM_METHOD)&&(d=e.data(Service.SYSTEM_METHOD)),Service.LoadedForm=e,s=a.serializeArray()}}if(Service.LoadedForm.length<=0)return Service.ActionLoading=!1,!1;if(void 0!==o&&Controller.hasOwnProperty(o)&&(S=Controller[o]()),c=Service.FormData(s),void 0===l||l.length<=0)return Service.ActionLoading=!1,!1;d=d.toUpperCase();const u=Service.LoadedForm.find("input[type='file']");if(u.length>0&&jQuery(u).each((function(e){if(u[e].files.length>1){let t=u[e].name;"]"!==t.substring(t.length-1,t.length)&&(t=`${u[e].name}[]`);for(let r=0;r<u[e].files.length;r++)c.append(t,u[e].files[r])}else c.append(u[e].name,u[e].files[0])})),void 0!==n&&(c=Service.ExecuteSubmitTransformation(n,Service.LoadedForm,c,t)),!1===Service.CanSubmitForm)return Service.ActionLoading=!1,!1;let v=Service.SuccessHandler,p=Service.ErrorHandler,T=t.data(Service.SYSTEM_SUCCESS_HANDLER),E=t.data(Service.SYSTEM_ERROR_HANDLER);void 0!==T&&Controller.hasOwnProperty(T)&&(v=Controller[T]),void 0!==E&&Controller.hasOwnProperty(E)&&(p=Controller[E]);const f=new Requirement;f.Params=c,f.SuccessHandler=v,f.ErrorHandler=p,f.Complete=i,f.Site=l,f.Request=d,f.ActionBtn=t,f.Component=Service.LoadedForm,f.Headers=S,Service.ServerRequest(f)})),Controller.AddProperty("FileSelect",(function(e){if(Service.ActionLoading)return!1;const t=jQuery(e);Service.ActionLoading=!0;let r=t.data(Service.SYSTEM_TARGET),n=t.data(Service.SYSTEM_COMPLETE);const i=void 0===r?jQuery(t.parents(Service.SYSTEM_FILE_UPLOAD_CONTAINER)):jQuery(document).find(`#${r}`);let o=i.find("input[type=file]"),a=i.find("img");o.click(),o.change((function(){Service.ImagePreview(o,a)})),o.change(),void 0!==n&&Service.ExecuteCustom(n,i,t),Service.ActionLoading=!1})),Controller.AddProperty("ModalSelect",(function(e){if(Service.ModalLoading)return!1;const t=jQuery(e);if(Service.ModalLoading=!0,t.data(Service.SYSTEM_LOAD_TYPE,"modal"),null===Service.LoadedModal){let e=t.data(Service.SYSTEM_ACTION);Service.FindElement(e,t).then((e=>{Service.ExecuteCustom(t.data(Service.SYSTEM_CUSTOM),e,t).then((()=>{Service.LoadData(e,t).then((r=>{r?Service.LoadModal(e,t).then((e=>{Service.LaunchModal(e,t).then((()=>{Service.ExecuteCustom(t.data(Service.SYSTEM_COMPLETE),e,t).then((()=>{Service.LoadedModal=e,Service.ModalLoading=!1}))}))})):(e=Service.DefaultModalHandler(Service.DefaultElementHandler(t),t),Service.LoadModal(e,t).then((e=>{Service.LaunchModal(e,t).then((()=>{e.find(".modal-title").empty().text("Modal Launch Error"),Service.LoadedModal=e,Service.ModalLoading=!1}))})))}))}))}))}else Service.ModalLoading=!1})),Controller.AddProperty("PanelSelect",(function(e){const t=jQuery(e),r=t.data(Service.SYSTEM_ACTION);if(-1!==jQuery.inArray(r,Service.PanelLoading))return!1;Service.PanelLoading.push(t.data(Service.SYSTEM_ACTION)),t.data(Service.SYSTEM_LOAD_TYPE,"panel");const n=t.data(Service.SYSTEM_HISTORY),i={},o=[Service.SYSTEM_ACTION,Service.SYSTEM_COMPLETE,Service.SYSTEM_TARGET,Service.SYSTEM_CUSTOM,Service.SYSTEM_HISTORY,Service.SYSTEM_NOTIFICATION_ON_SUCCESS,Service.SYSTEM_NOTIFICATION_ON_ERROR,Service.SYSTEM_NOTIFICATION,Service.SYSTEM_TITLE];jQuery.each(t.data(),(function(e,t){(-1!==jQuery.inArray(e,o)||"string"==typeof t)&&(i[e]=t)})),void 0===n&&window.history.pushState({data:i,panelSelect:!0},"");const a=void 0!==t.data(Service.SYSTEM_TITLE)?t.data(Service.SYSTEM_TITLE):t.data(Service.SYSTEM_ACTION);window.document.title=`${Service.Title} - ${a}`,Service.FindElement(t.data(Service.SYSTEM_ACTION),t).then((e=>{Service.ExecuteCustom(t.data(Service.SYSTEM_CUSTOM),e,t).then((()=>{Service.LoadData(e,t).then((n=>{const i=void 0!==t.data(Service.SYSTEM_TARGET)&&null!==t.data(Service.SYSTEM_TARGET)&&t.data(Service.SYSTEM_TARGET).length>0?t.data(Service.SYSTEM_TARGET):MainContainer;if(n)Service.LoadPanel(e,t,t.data(Service.SYSTEM_TARGET)).then((e=>{Service.ExecuteCustom(t.data(Service.SYSTEM_COMPLETE),e,t).then((()=>{Service.LoadedPanel[i]={ActionButton:t,LoadedPanel:e}}))}));else{const e=jQuery("<div></div>");e.append(Service.DefaultElementHandler(t)),Service.LoadPanel(e,t,t.data(Service.SYSTEM_TARGET)).then((e=>{Service.LoadedPanel[i]={ActionButton:t,LoadedPanel:e}}))}const o=Service.PanelLoading.indexOf(r);Service.PanelLoading.splice(o,1)}))}))}))})),Controller.AddProperty("ReloadPanel",(function(e=null){if(null===e?e=MainContainer:"string"!=typeof e&&(e=jQuery(e).data("action")),void 0===Service.LoadedPanel[e])return;const t=Service.LoadedPanel[e].LoadedPanel,r=Service.LoadedPanel[e].ActionButton;Service.LoadData(t,r).then((n=>{if(n)Service.LoadPanel(t,r,e).then((t=>{Service.ExecuteCustom(r.data(Service.SYSTEM_COMPLETE),t,r).then((()=>{Service.LoadedPanel[e].LoadedPanel=t}))}));else{const t=jQuery("<div></div>");t.append(Service.DefaultElementHandler(r)),Service.LoadPanel(t,r,e).then((t=>{Service.LoadedPanel[e].LoadedPanel=t}))}}))})),window.onpopstate=function(e){const t=e.state;if(null!==t&&t.panelSelect){const e=jQuery("<a>");jQuery.each(t.data,(function(t,r){e.attr(`data-${t}`,r)})),e.attr("data-history",!0),Controller.PanelSelect(e[0])}};